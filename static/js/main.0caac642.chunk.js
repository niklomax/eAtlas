(this.webpackJsonpeatlas=this.webpackJsonpeatlas||[]).push([[0],{1027:function(e,t,n){e.exports=n(2010)},106:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"g",(function(){return i}));var a=n(49),r=n(419).DateTime,i=function(e){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":"Feature"===e.type&&null!==e.geometry?e.geometry.type:e.type},o=function(e){if(!e||"Feature"!==e.type)return null;var t={};return Object.keys(e.properties).forEach((function(n){var r=String,i=e.properties[n];d(i)?r=Date:Object(a.isNumber)(i)?r=Number:Object(a.isBoolean)(i)?r=Boolean:Object(a.isObject)(i)&&(r=Object),t[n]=r})),t},l=function(e,t){if(!e||!e.features)return null;var n={},a=new Set;return e.features.forEach((function(e){e.properties&&Object.keys(e.properties)&&Object.keys(e.properties).forEach((function(r){t&&t===r?a.add(e.properties[r]):("object"===typeof n[r]||(n[r]=new Set),n[r].add(e.properties[r]))}))})),t?Array.from(a):n},c=function(e,t,n){if(e&&t){var a=[],r=n;return n&&0!==n.length||(r=l({features:e},t)),e.forEach((function(e){Object.keys(e.properties).forEach((function(n){if(n===t){var i=r.indexOf(e.properties[n]);a[i]&&a[i].x===e.properties[n]?a[i].y+=1:a[i]={x:e.properties[n],y:1}}}))})),a}},s=function(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e&&t&&n&&t!==n){var r={};return e.forEach((function(e){var i=e.properties;if(i&&Object.keys(i)){var o=a&&new Date(i[n])&&new Date(i[n]).getFullYear()?new Date(i[n]).getFullYear():i[n];Object.keys(i).forEach((function(e){e===t&&(r[o]&&r[o][i[e]]?r[o][i[e]]+=1:r[o]=Object.assign(r[o]||{},{[i[e]]:1}))}))}})),r}},u=function(e,t){return e.features?e.features.map((function(e){var n={x:e.geometry.coordinates[0],y:e.geometry.coordinates[1]};return t&&e.properties[t]&&(n.size=e.properties[t]),n})):null};function d(e){return r.fromFormat(e+"","MMMM dd yyyy").isValid||r.fromFormat(e+"","MMMM d yyyy").isValid||r.fromFormat(e+"","MMM d yyyy").isValid||r.fromFormat(e+"","MMM dd yyyy").isValid||r.fromFormat(e+"","dd/MM/yyyy").isValid||r.fromFormat(e+"","dd-MM-yyyy").isValid||r.fromFormat(e+"","yyyy/mm/dd").isValid||r.fromFormat(e+"","yyyy-mm-dd").isValid||r.fromISO(e).isValid||r.fromHTTP(e).isValid||typeof e===Number&&r.fromMillis(e).isValid}},1061:function(e,t){},1069:function(e,t,n){},1180:function(e,t,n){},1500:function(e,t){},168:function(e,t,n){"use strict";var a=n(39),r=n(1),i=n.n(r),o=n(169);t.a=function(e){var t=Object(r.useState)([]),n=Object(a.a)(t,2),l=n[0],c=n[1],s=e.onSelectCallback,u=e.values,d=e.filter,f=e.multiVarSelect,m=e.title,p=e.single;return i.a.createElement(o.Select,{options:u,labelKey:"id",valueKey:"value",placeholder:m||"Choose",maxDropdownHeight:"300px",type:o.TYPE.search,multi:!p,onChange:function(e){var t=e.value;c(t),f?(0===Object.keys(t).length?delete f[d]:f[d]=new Set(t.map((function(e){return e.value}))),"function"===typeof s&&s(0===Object.keys(f).length?{what:""}:{what:"multi",selected:f})):"function"===typeof s&&s(t)},value:e.value||l})}},1987:function(e,t,n){},2004:function(e,t,n){e.exports=n.p+"static/media/notes.d652360a.md"},2010:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(209),o=n.n(i),l=n(39),c=n(2065),s=n(2043),u=n(2060),d=n(578),f=n(431),m=n(1004),p=n(276),h=n(56),g=n(57),y=n(107),v=n(67),b=n(68),E=n(2044),k=n(435),C=n(579),O=n(580),w=n(426),j=n(23),S=n(86),x=n.n(S),L=n(2040),_=n(2061),M=n(2041),N=n(2016),A=n(1014),P=n(2019),z=n(590),F=n(51),R=(n(1069),n(136)),T=n(588),I=n(75),D=S.PRD_URL,V=function(e){var t=D+"/api/quant";Object(j.h)(t,(function(n,a){if(a||2!=n.length)console.log(a);else{var r=[],i={};JSON.parse(n[1]).features.forEach((function(e){i[e.properties.msoa11cd]=e.geometry.coordinates})),n[0].forEach((function(e){var t=I.d([i[e.origin_msoacode],i[e.destination_msoacode]],{base:+e.base,hs2:+e.data});t.geometry.coordinates[0]&&t.geometry.coordinates[1]&&r.push(t)})),r=I.b(r),e&&e(r,t)}}))},U=n(622),H=n(636),W=n(434),B=function(e){return e?a.createElement(W.Card,{headerImage:e.image,title:e.title},a.createElement(W.StyledBody,null,e.body),a.createElement(W.StyledAction,null,a.createElement(F.Button,{onClick:function(){return"function"===typeof e.loadCallback&&e.loadCallback()},overrides:{BaseButton:{style:{width:"100%"}}}},e.button))):null},Y=n(581),G=S.PRD_URL,K=function(e){var t=a.useState(!1),n=Object(l.a)(t,2),r=n[0],i=n[1],o=e.urlCallback,c=e.toggleOpen;return a.createElement(a.Fragment,null,a.createElement(F.Button,{kind:F.KIND.secondary,size:F.SIZE.compact,onClick:function(){i((function(e){return!e})),"function"===typeof c&&c()}},"Add data"),a.createElement(R.Modal,{onClose:function(){"function"===typeof c&&c(),i(!1)},isOpen:r},a.createElement(R.ModalHeader,null,"Your data remains on your browser. It is NOT uploaded anywhere."),a.createElement(R.ModalBody,null,a.createElement(R.FocusOnce,null,a.createElement(H.a,{urlCallback:function(e){i(!1),"function"===typeof o&&o(e)}})),a.createElement(U.a,{contentCallback:function(e){var t=e.text,n=e.name;if(n&&(n.split(".")[1].match(/geo/)||n.split(".")[1].match(/json/)))try{var a=JSON.parse(t);"function"===typeof o&&o(null,a,n),i(!1)}catch(r){console.log(r)}else Y.csv2geojson(t,(function(e,t){e||"function"===typeof o&&o(null,t,n)}))}}),a.createElement(T.FlexGrid,{flexGridColumnCount:3,flexGridColumnGap:"scale800",flexGridRowGap:"scale800"},!Object({NODE_ENV:"production",PUBLIC_URL:"/eAtlas",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_MAPBOX_ACCESS_TOKEN:"pk.eyJ1IjoibGF5aWsiLCJhIjoiY2ppNXFndGNzMGtpaDNxbXNqd2Rqc3BqZyJ9.355os6YWhIKPVaSiX01QIA",REACT_APP_DEFAULT_URL:"https://raw.githubusercontent.com/layik/eatlas-data/main/casualties.csv"}).NO_CARDS&&function(){var e={SPENSER:{image:"images/spenser.png",body:"SPENSER Cambridge sample.",api:G+"/api/spenser"},QUANT:{image:"images/quant.png",body:"QUANT HS2 scenario example.",api:V}};return Object.keys(e).map((function(t){return a.createElement(T.FlexGridItem,Object.assign({key:t},q),a.createElement(B,{button:"Load",title:t,image:e[t].image,body:e[t].body,loadCallback:function(){var n=e[t].api;n&&"function"===typeof n?n((function(e,t){return o(void 0,e,t)})):"function"===typeof o&&o(n),i(!1)}}))}))}())),a.createElement(R.ModalFooter,null,a.createElement(R.ModalButton,{onClick:function(){i(!1),"function"===typeof c&&c()}},"Close"))))},q={display:"flex",alignItems:"center",justifyContent:"center"},Z=n(168),X=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).state={bases:["dark","basic","streets","bright","light","satellite","No map"],selected:"dark"},a}return Object(g.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.selected,a=t.bases,i=this.props.onSelectCallback;return r.a.createElement(Z.a,{title:"dark"===n?"Default(dark)":n,single:!0,values:a.map((function(e){return{id:e,value:e}})),onSelectCallback:function(t){var n=t&&t[0]?t[0].value:e.state.selected;e.setState({selected:n}),"function"===typeof i&&n&&i(n)}})}}]),n}(r.a.Component),J=n(61),Q=n(690),$=n(2066),ee=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).state={timeDuration:!1},a}return Object(g.a)(n,[{key:"componentWillUnmount",value:function(){this.dismissTimeoutId&&clearTimeout(this.dismissTimeoutId)}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(e.alert&&this.props.alert!==e.alert){var n=e.alert.time;this.setState({timeDuration:Boolean(alert)},(function(){t.dismissTimeout=setTimeout((function(){return t.setState({timeDuration:!1})}),n||3e3)}))}}},{key:"render",value:function(){var e=this.props.alert;return this.state.timeDuration&&e&&e.content?r.a.createElement($.a,{style:{border:"none",background:"#f8d7da",color:"#721c24",textAlign:"center"},variant:"danger"},e.content):null}}]),n}(a.Component),te=n(106);function ne(e){var t=e.colourCallback;return r.a.createElement("div",{className:"color-picker-container"},r.a.createElement("p",null,"Color range:"),j.d.map((function(e,n){return r.a.createElement("div",{key:e,style:{backgroundColor:0===n?"red":1===n?"blue":2===n?"green":3===n?"orange":4===n?"brown":"yellow"},className:"color-box",onClick:function(){"function"===typeof t&&t(e)}})})))}var ae=function(e){var t=a.useState(!1),n=Object(l.a)(t,2),r=n[0],i=n[1],o=e.toggleOpen,c=e.title,s=e.component,u=e.button;return a.createElement(a.Fragment,null,a.createElement("i",{style:{margin:5,cursor:"pointer",fontSize:"1.5em"},onClick:function(){"function"===typeof o&&o(),i(!0)},className:u||"fa fa-table"}),a.createElement(R.Modal,{size:"80%",onClose:function(){"function"===typeof o&&o(),i(!1)},isOpen:r},a.createElement(R.ModalHeader,null,c),a.createElement(R.ModalBody,null,s),a.createElement(R.ModalFooter,null,a.createElement(F.Button,{kind:F.KIND.secondary,size:F.SIZE.compact,onClick:function(){i(!1),"function"===typeof o&&o()}},"Okay"))))},re=n(691),ie=n(215),oe=n(186),le=n(701),ce=n(419),se=n(2017),ue=n(49),de=n(2045),fe=n(993),me=n.n(fe),pe=n(0),he=n.n(pe),ge=["AfterExport","AfterPlot","Animated","AnimatingFrame","AnimationInterrupted","AutoSize","BeforeExport","BeforeHover","ButtonClicked","Click","ClickAnnotation","Deselect","DoubleClick","Framework","Hover","LegendClick","LegendDoubleClick","Relayout","Relayouting","Restyle","Redraw","Selected","Selecting","SliderChange","SliderEnd","SliderStart","SunburstClick","Transitioning","TransitionInterrupted","Unhover","WebGlContextLost"],ye=["plotly_restyle","plotly_redraw","plotly_relayout","plotly_relayouting","plotly_doubleclick","plotly_animated","plotly_sunburstclick"],ve="undefined"!==typeof window;var be=function(e){var t=function(t){Object(v.a)(a,t);var n=Object(b.a)(a);function a(e){var t;return Object(h.a)(this,a),(t=n.call(this,e)).p=Promise.resolve(),t.resizeHandler=null,t.handlers={},t.syncWindowResize=t.syncWindowResize.bind(Object(y.a)(t)),t.syncEventHandlers=t.syncEventHandlers.bind(Object(y.a)(t)),t.attachUpdateEvents=t.attachUpdateEvents.bind(Object(y.a)(t)),t.getRef=t.getRef.bind(Object(y.a)(t)),t.handleUpdate=t.handleUpdate.bind(Object(y.a)(t)),t.figureCallback=t.figureCallback.bind(Object(y.a)(t)),t.updatePlotly=t.updatePlotly.bind(Object(y.a)(t)),t}return Object(g.a)(a,[{key:"updatePlotly",value:function(t,n,a){var r=this;this.p=this.p.then((function(){if(!r.unmounting){if(!r.el)throw new Error("Missing element reference");return e.react(r.el,{data:r.props.data,layout:r.props.layout,config:r.props.config,frames:r.props.frames})}})).then((function(){r.unmounting||(r.syncWindowResize(t),r.syncEventHandlers(),r.figureCallback(n),a&&r.attachUpdateEvents())})).catch((function(e){r.props.onError&&r.props.onError(e)}))}},{key:"componentDidMount",value:function(){this.unmounting=!1,this.updatePlotly(!0,this.props.onInitialized,!0)}},{key:"componentDidUpdate",value:function(e){this.unmounting=!1;var t=e.frames&&e.frames.length?e.frames.length:0,n=this.props.frames&&this.props.frames.length?this.props.frames.length:0,a=!(e.layout===this.props.layout&&e.data===this.props.data&&e.config===this.props.config&&n===t),r=void 0!==e.revision,i=e.revision!==this.props.revision;(a||r&&(!r||i))&&this.updatePlotly(!1,this.props.onUpdate,!1)}},{key:"componentWillUnmount",value:function(){this.unmounting=!0,this.figureCallback(this.props.onPurge),this.resizeHandler&&ve&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null),this.removeUpdateEvents(),e.purge(this.el)}},{key:"attachUpdateEvents",value:function(){var e=this;this.el&&this.el.removeListener&&ye.forEach((function(t){e.el.on(t,e.handleUpdate)}))}},{key:"removeUpdateEvents",value:function(){var e=this;this.el&&this.el.removeListener&&ye.forEach((function(t){e.el.removeListener(t,e.handleUpdate)}))}},{key:"handleUpdate",value:function(){this.figureCallback(this.props.onUpdate)}},{key:"figureCallback",value:function(e){if("function"===typeof e){var t=this.el;e({data:t.data,layout:t.layout,frames:this.el._transitionData?this.el._transitionData._frames:null},this.el)}}},{key:"syncWindowResize",value:function(t){var n=this;ve&&(this.props.useResizeHandler&&!this.resizeHandler?(this.resizeHandler=function(){return e.Plots.resize(n.el)},window.addEventListener("resize",this.resizeHandler),t&&this.resizeHandler()):!this.props.useResizeHandler&&this.resizeHandler&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null))}},{key:"getRef",value:function(e){this.el=e,this.props.debug&&ve&&(window.gd=this.el)}},{key:"syncEventHandlers",value:function(){var e=this;ge.forEach((function(t){var n=e.props["on"+t],a=e.handlers[t],r=Boolean(a);n&&!r?e.addEventHandler(t,n):!n&&r?e.removeEventHandler(t):n&&r&&n!==a&&(e.removeEventHandler(t),e.addEventHandler(t,n))}))}},{key:"addEventHandler",value:function(e,t){this.handlers[e]=t,this.el.on(this.getPlotlyEventName(e),this.handlers[e])}},{key:"removeEventHandler",value:function(e){this.el.removeListener(this.getPlotlyEventName(e),this.handlers[e]),delete this.handlers[e]}},{key:"getPlotlyEventName",value:function(e){return"plotly_"+e.toLowerCase()}},{key:"render",value:function(){return r.a.createElement("div",{id:this.props.divId,style:this.props.style,ref:this.getRef,className:this.props.className})}}]),a}(a.Component);return ge.forEach((function(e){t.propTypes&&(t.propTypes["on"+e]=he.a.func)})),t.defaultProps={debug:!1,useResizeHandler:!1,data:[],style:{position:"relative",display:"inline-block"}},t}(me.a),Ee=function(e){var t=e.data,n=e.width,a=void 0===n?250:n,i=e.height,o=void 0===i?200:i,l=e.title,c=void 0===l?"Plot":l,s=e.dark,u=e.xaxis,d=void 0===u?{}:u,f=e.yaxis,m=void 0===f?{}:f,p=e.displayModeBar,h={visible:!0,color:s&&"#fff"},g={color:s&&"#fff"};return t&&Object(ue.isArray)(t)&&0!==t.length?r.a.createElement(be,{data:t,layout:{width:a,height:o,title:{text:c,font:g},margin:{t:30,r:20,b:50,l:30},paper_bgcolor:s&&"#0000",plot_bgcolor:s&&"#0000",xaxis:Object.assign(h,d),yaxis:Object.assign(g,m),legend:{x:.35,y:-.35,orientation:"h",font:g}},config:{displayModeBar:!p&&!1}}):null},ke=S.PLOT_W,Ce=function(e,t){var n=Object(ue.isArray)(e)&&e.length>0&&t,a=[[],[],[]];if(n){var r=1===e.length?0:Math.floor(Math.random()*(e.length-1)+1),i=Object.keys(e[r].properties).filter((function(t){return Object(te.d)(e[r].properties[t])}));if(i.length>0){var o=Object(te.f)(e,t,i[0]);o&&Object.keys(o).length>1&&Object.keys(o).forEach((function(e){e&&o[e].Male&&o[e].Female&&(a[0].push({x:e,y:o[e].Male}),a[1].push({x:e,y:o[e].Female}),a[2].push({x:e,y:o[e].Male+o[e].Female}))}))}}return a[0].length?a:null},Oe=n(421),we=n(969),je=n(269),Se=n(2057),xe=(n(1987),function(e){e.className;var t=e.data,n=(e.marginLeft,e.marginTop,e.lineAttrs),a=e.plotStyle;if(!t||!Array.isArray(t)||0===t.length)return null;var i=!0;if(t.forEach((function(e){Object(ue.isNumber)(e)||(i=!1)})),!i)return null;var o=a&&a.height||100,l=t.sort(je.a);l=l.map((function(e){return Object(j.g)(e,{oldMax:l[l.length-1],oldMin:l[0],newMax:95,newMin:5})}));var c=+Object(Se.a)(l,.25).toFixed(2),s=+Object(Se.a)(l,.5).toFixed(2),u=+Object(Se.a)(l,.75).toFixed(2),d=+(u-c).toFixed(2),f=+(c-1.5*d).toFixed(2),m=+(c+1.5*d).toFixed(2),p=l.filter((function(e){return e>m||e<f})),h=t;return t.length>5&&(h=[],t.forEach((function(e,n){var a=Math.floor(t.length/5);if(1===a&&(a=2),n%a===0){var r=Math.floor(e);r>1e3&&(r=(r/1e3).toFixed(1)+"k"),h.push(r)}}))),r.a.createElement("div",{style:{width:"100%",height:o,position:"relative",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("div",{style:{width:"100%",height:"100%",maxWidth:"600px"}},r.a.createElement("svg",{width:"100%",height:"100%"},r.a.createElement("g",{style:{stroke:a&&a.lineColor||"rgb(18, 147, 154)"}},r.a.createElement("line",Object.assign({x1:f+"%",x2:c+"%",y1:"35%",y2:"35%"},n)),r.a.createElement("line",Object.assign({style:{strokeWidth:1},x1:f+"%",x2:f+"%",y1:"5%",y2:"65%"},n)),r.a.createElement("line",Object.assign({x1:m+"%",x2:u+"%",y1:"35%",y2:"35%"},n)),r.a.createElement("line",Object.assign({style:{strokeWidth:1},x1:m+"%",x2:m+"%",y1:"5%",y2:"65%"},n)),r.a.createElement("rect",{x:c+"%",width:d+"%",y:"5%",height:"60%",fill:a&&a.fillColor||"rgb(18, 147, 154)",stroke:"black 0.5px"}),r.a.createElement("line",Object.assign({style:{stroke:"black",strokeWidth:1},x1:s+"%",x2:s+"%",y1:"5%",y2:"65%"},n)),p.map((function(e,t){return r.a.createElement("circle",{key:e+"-"+t,r:"5",cx:(e>m?e+2:e-2)+"%",cy:"35%",style:{fill:"none",opacity:1}})})),h&&h.map((function(e,t){var n=t*(100/h.length);return r.a.createElement("g",{key:n+"-"+t},r.a.createElement("text",{x:n+2+"%",y:"85%",className:"d3-axis-labels"},e))}))))))}),Le=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).state={radius:100,elevation:4,year:"",reset:!1,multiVarSelect:{},barChartVariable:"road_type",datasetName:e.datasetName},a}return Object(g.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){var n=this.props,a=n.data,r=n.alert,i=n.loading,o=this.state,l=o.elevation,c=o.radius,s=o.reset,u=o.barChartVariable;return s!==t.reset||l!==t.elevation||c!==t.radius||r!==e.alert||i!==e.loading||u!==t.barChartVariable||!(a&&e&&e.data&&a.length===e.data.length)}},{key:"render",value:function(){var e=this,t=this.state,n=t.elevation,a=t.radius,i=t.year,o=t.subsetBoundsChange,l=t.multiVarSelect,c=t.barChartVariable,s=this.props,u=s.onChangeRadius,d=s.onChangeElevation,f=s.onSelectCallback,m=s.data,p=s.colourCallback,h=s.unfilteredData,g=s.toggleSubsetBoundsChange,y=s.urlCallback,v=s.alert,b=s.onlocationChange,E=s.column,k=s.dark,C=s.toggleOpen,O=s.toggleHexPlot,w=m&&m.length>1,x=Object(te.e)(m,"accident_severity"),R=[],T=w?Object(j.x)(m,E||c):[];w&&m[0].geometry.type.toLowerCase();w&&E&&Object(ue.isNumber)(m[0].properties[E])&&(R=T.map((function(e){return e.x})),R=Object(j.v)(R),this.props.showLegend(Object(j.k)({domain:R,title:Object(j.p)(E)})));var I={data:T,opacity:1,stroke:"rgb(72, 87, 104)",fill:"rgb(18, 147, 154)"},D=function(t,n){e.setState({reset:!n,year:"",multiVarSelect:{},barChartVariable:"road_type",datasetName:t||e.state.datasetName})};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{color:k?"white":"black",background:k?"#242730":"white"},className:"side-panel"},r.a.createElement(ee,{alert:v}),r.a.createElement("div",{style:{background:k?"#29323C":"#eee"},className:"side-pane-header"},r.a.createElement("h2",null,m&&m.length?m.length+" row"+(m.length>1?"s":"")+".":"Nothing to show"),w&&r.a.createElement("h6",{className:"truncate"},"dataset: ",this.state.datasetName)),r.a.createElement("div",null,r.a.createElement(K,{toggleOpen:function(){return"function"===typeof C&&C()},urlCallback:function(e,t,n){D(e||n),"function"===typeof y&&y(e,t),"function"===typeof C&&C()}}),w&&r.a.createElement(ae,{toggleOpen:function(){return"function"===typeof C&&C()},component:r.a.createElement(re.a,{data:m})}),this.state.reset&&r.a.createElement(F.Button,{kind:F.KIND.secondary,size:F.SIZE.compact,onClick:function(){D(void 0,!0),"function"===typeof y&&y(),"function"===typeof e.props.showLegend&&e.props.showLegend(!1)}},"Reset")),r.a.createElement("div",{className:"side-panel-body"},r.a.createElement("div",{className:"side-panel-body-content"},function(e){var t=e.data,n=e.year,a=e.multiVarSelect,i=e.onSelectCallback,o=e.callback;if(!(t&&t.length>1&&(t[0].properties.date||t[0].properties.YEAR)&&(ce.DateTime.fromFormat(t[0].properties.date+"","yyyy-mm-dd").isValid||ce.DateTime.fromFormat(t[0].properties.YEAR+"","yyyy").isValid)))return null;var l=Object(te.c)({features:t},"date").map((function(e){return+e.split("-")[0]})).sort();return r.a.createElement(le.a,{title:r.a.createElement("h5",null,"Year(s): ",n||l[0]+" - "+l[l.length-1],n&&r.a.createElement("i",{style:{fontSize:"2rem"},className:"fa fa-trash",onClick:function(){a.date?delete a.date:delete a.YEAR,"function"===typeof i&&i(0===Object.keys(a).length?{what:""}:{what:"multi",selected:a}),o({year:"",multiVarSelect:a})}})),sublist:Object(ie.a)(new Set(l)),suggested:"slider",onChange:function(e){a[t[0].properties.date?"date":"YEAR"]=new Set([e+""]),o({year:e+"",multiVarSelect:a}),"function"===typeof i&&i({selected:a,what:"multi"})}})}({data:h,year:i,multiVarSelect:l,onSelectCallback:f,callback:function(t){return e.setState(t)}}),r.a.createElement("br",null),x&&x.map((function(t){return Object(j.s)(t.x,100*t.y/m.length,(function(){l&&l.accident_severity&&l.accident_severity.has(t.x)?delete l.accident_severity:(l.accident_severity=new Set([t.x]),e.setState({multiVarSelect:l})),f&&f(0===Object.keys(l).length?{what:""}:{what:"multi",selected:l})}),k)})),r.a.createElement("hr",{style:{clear:"both"}}),R.length>1&&r.a.createElement(xe,{data:R}),r.a.createElement(L.a,{defaultActiveKey:"1",id:"main-tabs"},r.a.createElement(_.a,{eventKey:"1",title:r.a.createElement("i",{style:{fontSize:"2rem"},className:"fa fa-info"})},r.a.createElement(we.a,{data:m,dark:k,plotStyle:{width:240,margin:20}}),function(e,t,n){if(!e||!Object(ue.isArray)(e)||!e.length)return null;var a=e[0].properties.hasOwnProperty(t)&&Object(j.x)(e,t);return a?r.a.createElement(Ee,{dark:n,yaxis:{showgrid:!1},xaxis:{showgrid:!1},data:[{x:a.map((function(e){return+e.x})),y:a.map((function(e){return+e.y})),marker:{color:S.TURQUOISE_RANGE[0]}}],title:Object(j.p)(t)}):null}(m,"age_of_casualty",k),function(e,t,n){if(!e||!Object(ue.isArray)(e)||!e.length||!t)return null;var a=Ce(e,t);return a?r.a.createElement(Ee,{dark:n,yaxis:{showgrid:!1},xaxis:{showgrid:!1},data:a.map((function(e,t){return{mode:"lines",showlegend:!1,x:e.map((function(e){return e.x})).sort((function(e,t){return new Date(e)-new Date(t)})),y:e.map((function(e){return e.y})),name:["Male","Female","Total"][t],marker:{color:Object(de.a)(S.TURQUOISE_RANGE)(t/a.length)}}})),title:"Sex of Casualty"}):null}(m,"sex_of_casualty",k),w&&Object.keys(m[0].properties).filter((function(e){return!Object(ue.isEmptyOrSpaces)(e)})).length>0&&"grid"!==this.props.layerStyle&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h6",null,"Column for layer:"),r.a.createElement(Z.a,{title:"Choose Column",single:!0,values:Object.keys(m[0].properties).map((function(e){return{id:Object(j.p)(e),value:e}})),onSelectCallback:function(t){var n=t&&t[0]?t[0].value:c;e.setState({barChartVariable:n}),"function"===typeof f&&f({what:"column",selected:n})}})),r.a.createElement(Oe.a,{dark:k,data:I.data,type:J.j,onValueClick:function(t){l[E||c]=new Set([t.x+""]),e.setState({multiVarSelect:l}),f&&f({what:"multi",selected:l})},onDragSelected:function(t){l[E||c]=new Set(t.map((function(e){return e+""}))),e.setState({multiVarSelect:l}),f&&f({what:"multi",selected:l})},plotStyle:{marginBottom:100},noYAxis:!0}),function(e){if(e&&e.data&&e.data[0]&&e.data[0].properties.date&&e.data[0].properties.sex_of_casualty){var t=Object(te.f)(e.data,"sex_of_casualty","date"),n=[],a=[];if(1!==Object.keys(t).length)return t&&Object.keys(t).forEach((function(e,a){n.push({x:0,x0:+t[e].Male,y:0===a?0:a,y0:a+1,color:"#428BCA"})})),t&&Object.keys(t).forEach((function(e,n){a.push({x:0,x0:-1*+t[e].Female,y:0===n?0:n,y0:n+1})})),r.a.createElement(r.a.Fragment,null,r.a.createElement(J.l,{margin:{left:e.margin||60},height:e.plotStyle&&e.plotStyle.height||ke,width:e.plotStyle&&e.plotStyle.width||ke},r.a.createElement(J.f,{color:"rgb(18, 147, 154)",stroke:"black",data:a}),r.a.createElement(J.f,{color:"rgb(239, 93, 40)",stroke:"black",data:n}),r.a.createElement(J.m,{tickSize:0,tickFormat:function(e){return 0===e?2009:e-2+2009},style:{line:{strokeWidth:0},text:{fill:e.dark?"#fff":"#000",fontWeight:400}}}),r.a.createElement(J.k,{tickSize:0,tickFormat:function(e){return Object(se.a)(".2s")(e<0?-1*e:e)},style:{line:{strokeWidth:0},text:{fill:e.dark?"#fff":"#000",fontWeight:400}}})),r.a.createElement(J.a,{orientation:"horizontal",width:ke,items:[{title:"Male",color:"rgb(239, 93, 40)"},{title:"Female",color:"rgb(18, 147, 154)"}]}))}}({data:m,dark:k})),r.a.createElement(_.a,{eventKey:"2",title:r.a.createElement("i",{style:{fontSize:"2rem"},className:"fa fa-sliders"})},w&&r.a.createElement("div",null,r.a.createElement(ne,{colourCallback:function(e){return"function"===typeof p&&p(e)}}),r.a.createElement("h5",null,"Radius"),r.a.createElement(oe.Slider,{value:[a],min:50,max:1e3,step:50,onChange:function(t){var n=t.value;e.setState({radius:n[0]}),"function"===typeof u&&u(n[0])}}),r.a.createElement("h5",null,"Elevation"),r.a.createElement(oe.Slider,{value:[n],min:2,max:8,step:2,onChange:function(t){var n=t.value;e.setState({elevation:n[0]}),"function"===typeof d&&u(n[0])}})),w&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h6",null,"Deck Layer:"),r.a.createElement(Z.a,{title:"Choose Layer",single:!0,values:S.LAYERSTYLES.map((function(e){return{id:Object(j.p)(e),value:e}})),onSelectCallback:function(t){var n=t&&t[0]?t[0].value:c;e.setState({barChartVariable:n}),"function"===typeof f&&f({what:"layerStyle",selected:n})}})),"Map Styles",r.a.createElement("br",null),r.a.createElement(X,{onSelectCallback:function(e){return f&&f({selected:e,what:"mapstyle"})}}),w&&r.a.createElement(r.a.Fragment,null,r.a.createElement(M.a,{onChange:function(){return O&&O()}},"Hex Plot"),r.a.createElement(M.a,{onChange:function(){e.setState({subsetBoundsChange:!o}),g&&"function"===typeof g&&g(!o)}},"Subset by map boundary"))),r.a.createElement(_.a,{eventKey:"3",title:r.a.createElement("i",{style:{fontSize:"2rem"},className:"fa fa-filter"},l&&Object.keys(l).length?Object.keys(l).length:"")},h&&h.length>0&&r.a.createElement(Q.a,{dark:k,multiVarSelect:l,onSelectCallback:function(t){"function"===typeof f&&f(0===Object.keys(t).length?{what:""}:{what:"multi",selected:t}),e.setState({multiVarSelect:t})},unfilteredData:h})))),r.a.createElement("div",{className:"space"}),r.a.createElement("form",{className:"search-form",onSubmit:function(t){t.preventDefault(),Object(j.t)(e.state.search,(function(e){var t=e&&e.length>0&&e[0].boundingbox;t=t&&t.map((function(e){return+e})),"function"===typeof b&&t&&b({bbox:t,lon:+e[0].lon,lat:+e[0].lat})}))}},r.a.createElement(N.a,null,r.a.createElement(A.a,null,r.a.createElement(P.a,{style:{background:k?"#242730":"white",color:k?"white":"black"},onChange:function(t){return e.setState({search:t.target.value})},placeholder:"fly to...",type:"text"}),r.a.createElement(A.a.Addon,{style:{background:k?"#242730":"white",color:k?"white":"black"}},r.a.createElement(z.a,{glyph:"search"}))))))))}}]),n}(r.a.Component),_e=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={hoveredNode:null,radius:10,offset:0},e}return Object(g.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.data,a=t.options,i=this.state,o=i.radius;i.hoveredNode;return n&&n.length?r.a.createElement("div",{className:"centered-and-flexed",style:{color:"#fff"}},r.a.createElement(oe.Slider,{value:[this.state.radius],min:5,max:50,step:5,onChange:function(t){var n=t.value;e.setState({radius:n[0]})}}),"Radius (pixels)",r.a.createElement(J.l,{margin:{left:10,bottom:10},height:a&&a.plotStyle&&a.plotStyle.height||350,width:a&&a.plotStyle&&a.plotStyle.width||350,onMouseLeave:function(){return e.setState({hoveredNode:null})}},r.a.createElement(J.c,{animation:!0,className:"hexbin-example",style:{stroke:"#125C77",strokeLinejoin:"round"},colorRange:["orange","cyan"],radius:o,data:n}),a&&!a.noXAxis&&r.a.createElement(J.k,{tickLabelAngle:-45,style:{text:{fill:"#fff",fontWeight:400}}}),a&&!a.noYAxis&&r.a.createElement(J.m,{tickLabelAngle:-45,style:{text:{fill:"#fff",fontWeight:400}}}))):null}}]),n}(a.Component),Me=function(e){var t=Object(a.useState)(!1===e.isMobile),n=Object(l.a)(t,2),i=n[0],o=n[1];Object(a.useEffect)((function(){!0!==e.open&&o(e.open)}),[e.open]);var c=e.data,s=c&&c.length>1;return s&&"POINT"===c[0].geometry.type.toUpperCase()?r.a.createElement("div",{style:{marginRight:i?0:-350},className:"right-panel-container"},r.a.createElement("div",{className:"close-button",onClick:function(){return o(!i)},style:{color:"white"}},r.a.createElement("i",{style:{marginLeft:-16,bottom:0,position:"absolute",backgroundColor:"#242730",fontSize:"2rem",color:"white !important"},className:i?"fa fa-arrow-circle-right":"fa fa-arrow-circle-left"})),r.a.createElement("div",{className:"right-side-panel"},s&&r.a.createElement(_e,{data:Object(te.a)({features:c}),options:{noXAxis:!0,noYAxis:!0}}))):null},Ne=function(e){var t=Object(a.useState)(!e.isMobile),n=Object(l.a)(t,2),i=n[0],o=n[1],c=Object(a.useState)(!1),s=Object(l.a)(c,2),u=s[0],d=s[1];return r.a.createElement("div",{className:"side-panel-container",style:{marginLeft:i?0:"-320px"}},r.a.createElement(Le,Object.assign({},e,{toggleOpen:function(){return o((function(e){return!e}))},toggleHexPlot:function(){return d((function(e){return!e}))}})),u&&r.a.createElement(Me,{open:i,isMobile:e.isMobile,data:e.data}),r.a.createElement("div",{className:"close-button",onClick:function(){return o(!i)},style:{color:"white"}},r.a.createElement("div",{style:{backgroundColor:"#242730"}},r.a.createElement("i",{style:{fontSize:"2rem",color:"white !important"},className:i?"fa fa-arrow-circle-left":"fa fa-arrow-circle-right"}))))},Ae=n(272),Pe=Object(Ae.a)(),ze=(n(964),n(420)),Fe=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this)).state={isMobile:e.isMobile},a._listPropsAndValues=a._listPropsAndValues.bind(Object(y.a)(a)),a}return Object(g.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this._handleWindowSizeChange.bind(this))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._handleWindowSizeChange.bind(this))}},{key:"_handleWindowSizeChange",value:function(){this.forceUpdate()}},{key:"render",value:function(){var e=this.props,t=e.topx,n=e.topy,a=e.hoveredObject,i=e.column1,o=void 0===i?"accident_severity":i,l=e.column2,c=void 0===l?"date":l,s=this.state.isMobile;if(!a)return null;var u=a.type&&"Feature"===a.type,d=a&&a.cluster,f=[];if(!u&&!d){var m=o&&Object(te.c)({features:a.points.map((function(e){return e.source}))},o),p=o&&c&&Object(te.f)(a.points.map((function(e){return e.source})),o,c);m&&m.forEach((function(e,t){Object.keys(p).forEach((function(n){n&&p[n][e]&&(f[t]||(f[t]={x:[],y:[],name:e,marker:{color:Object(de.a)(S.TURQUOISE_RANGE)(t/m.length)}}),f[t].x.push(n),f[t].y.push(p[n][e]))}))})),f.map((function(e){e.x.length>1&&(e.mode="lines")}))}var h=window.innerWidth,g=window.innerHeight,y=s?10:n+300>g?n-220:n,v=s?10:t+220>h?t-220:t;return r.a.createElement("div",{className:"xyz",style:{top:n+300>g?y:n,left:t+220>h?v:t}},r.a.createElement("div",null,r.a.createElement("b",null,"Total: ",d?a.point_count:u?1:a.points.length)),r.a.createElement("div",null,!d&&(u||a.points.length<=2)?this._listPropsAndValues(a):r.a.createElement(Ee,{title:"".concat(Object(j.p)(o)," by ").concat(Object(j.p)(c)),width:220,data:f,dark:!0,xaxis:{tickformat:"d",showgrid:!1},yaxis:{showgrid:!1}})))}},{key:"_listPropsAndValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;if(!e.properties||!e.points[0].properties)return null;var a=[],i=e.properties;if(i){var o=Object.keys(i);a=o.slice(1,t?o.length:n).map((function(e){return[Object(j.p)(e),i[e]]}))}else{var l=Object.keys(e.points[0].properties);a=l.slice(1,t?l.length:n).map((function(t){var n=[Object(j.p)(t),e.points[0].properties[t]];return e.points[1]&&n.push(e.points[1].properties[t]),n}))}return r.a.createElement(ze.Table,{style:{maxWidth:"320px"},columns:e.points&&2===e.points.length?["Property","Value p1","Value p2"]:["Property","Value"],data:a})}}]),n}(r.a.Component),Re=(x.a.PRD_URL,"https://raw.githubusercontent.com/layik/eatlas-data/main/casualties.csv"),Te="linear-gradient(to top, red , yellow)",Ie=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(e){var a;Object(h.a)(this,n),(a=t.call(this,e))._resize=function(){a.setState({width:window.innerWidth,height:window.innerHeight})};var r=x.a.DECKGL_INIT,i=Object(j.o)(e.location.search);return i&&Object.keys(i).forEach((function(e){Object.keys(r).forEach((function(t){t.startsWith(e)&&(r[e]=i[e])}))})),a.state={loading:!0,layers:[],backgroundImage:Te,radius:100,elevation:4,mapStyle:"mapbox://styles/mapbox/"+(e.dark?"dark":"streets")+"-v9",initialViewState:r,subsetBoundsChange:!1,lastViewPortChange:new Date,colourName:"default",iconLimit:500,legend:!1,width:window.innerWidth,height:window.innerHeight,tooltipColumns:{column1:"accident_severity",column2:"date"}},a._generateLayer=a._generateLayer.bind(Object(y.a)(a)),a._renderTooltip=a._renderTooltip.bind(Object(y.a)(a)),a._fetchAndUpdateState=a._fetchAndUpdateState.bind(Object(y.a)(a)),a._fitViewport=a._fitViewport.bind(Object(y.a)(a)),a}return Object(g.a)(n,[{key:"componentDidMount",value:function(){this._fetchAndUpdateState(),window.addEventListener("resize",this._resize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resize)}},{key:"_fetchAndUpdateState",value:function(e,t){var n=this;if((!e||Object(j.r)(e))&&(!t||"object"===typeof t)){var a=e||Re;Object(j.h)(a,(function(e,r){r?n.setState({loading:!1,alert:{content:"Could not reach: "+a}}):(n.setState({loading:!1,data:e,alert:t||null}),n._fitViewport(e),n._generateLayer())}))}}},{key:"_generateLayer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.radius,a=t.elevation,r=t.filter,i=t.cn;if(r&&"mapstyle"===r.what)this.setState({mapStyle:r&&"mapstyle"===r.what?"mapbox://styles/mapbox/"+r.selected+"-v9":this.state.mapStyle});else{var o=this.state.data&&this.state.data.features,l=this.state,c=l.colourName,s=l.iconLimit,u=r&&"column"===r.what&&r.selected||this.state.column;if(o){r&&"%"===r.what&&(o=o.slice(0,r.selected/100*o.length)),this.state.coords&&(o=this.state.filtered);var d=Object(te.g)(o[0]).toLowerCase();r&&""!==r.selected&&(o=o.filter((function(t){if("multi"===r.what)for(var n=r.selected,a=0,i=Object.keys(n);a<i.length;a++){var o=i[a],l="date"===o?t.properties[o].split("-")[0]:t.properties[o]+"";if(!n[o].has(l))return!1}return"coords"!==r.what||0===w.a.difference(r.selected||e.state.coords,t.geometry.coordinates.flat()).length})));var f=r&&"layerStyle"===r.what&&r.selected||this.state.layerStyle||"grid";"point"!==d&&(f="geojson");var m=o.length<s&&!u&&(!r||"layerStyle"!==r.what)&&"point"===d;m&&(f="icon");var p={radius:n||this.state.radius,cellSize:n||this.state.radius,elevationScale:a||this.state.elevation,lightSettings:S.LIGHT_SETTINGS,colorRange:Object(j.e)(i||c)},h=r&&"column"===r.what&&r.selected||u||1;if("heatmap"===f&&(p.getPosition=function(e){return e.geometry.coordinates}),"linestring"===d&&(f="line",p.getColor=function(e){return[235,170,20]},p.getPath=function(e){return e.geometry.coordinates},p.onClick=function(t){t&&t.hasOwnProperty("coordinate")&&["path","arc","line"].includes(e.state.layerStyle)&&t.object.geometry.coordinates&&e._generateLayer({filter:{what:"coords",selected:t.object.geometry.coordinates[0]}})},"line"===f&&(p.getSourcePosition=function(e){return e.geometry.coordinates[0]},p.getTargetPosition=function(e){return e.geometry.coordinates[1]}),Object(ue.isNumber)(o[0]&&o[0].properties&&o[0].properties[h]))){var g=o.map((function(e){return e.properties[h]})),y=Object(j.m)(g),v=Object(j.n)(g);p.getWidth=function(e){var t=10,n=.1;return o.length>1e5&&(t=.5,n=.005),Object(j.g)(e.properties[h],{oldMin:v,oldMax:y,newMax:t,newMin:n})}}var b=Object(j.j)(o,h);"polygon"!==d&&"multipolygon"!==d&&"geojson"!==f||(b&&b.length>50?p.getFillColor=function(e){return Object(j.b)(e.properties[Object(ue.isNumber)(h)?Object.keys(e.properties)[h]:h])}:p.getFillColor=function(e){return Object(j.f)(e,h,b)}),"barvis"===f&&(p.getPosition=function(e){return[e.geometry.coordinates[0],e.geometry.coordinates[1],0]},o[0].properties.result&&(p.getRotationAngle=function(e){return e.properties.result.includes("gain from")?45:1}),p.getScale=function(e){return 200});var E=Object(j.i)(f,o,this._renderTooltip,p);this.setState({alert:m?{content:"Switched to icon mode. "}:null,loading:!1,layerStyle:r&&"layerStyle"===r.what?r.selected:this.state.layerStyle,geomType:d,tooltip:"",filtered:o,layers:[E],radius:n||this.state.radius,elevation:a||this.state.elevation,road_type:r&&"road_type"===r.what?r.selected:this.state.road_type,colourName:i||c,column:u,coords:r&&"coords"===r.what?r.selected:this.state.coords})}}}},{key:"_fitViewport",value:function(e,t){var n=e||this.state.data;if(n&&0!==n.length||t){var a=t?t.bbox:Object(O.default)(n),r=t?[t.lon,t.lat]:Object(C.default)(n).geometry.coordinates;this.map.fitBounds(a,{padding:"100px"});var i=Object(p.a)(Object(p.a)({},this.state.viewport),{},{longitude:r[0],latitude:r[1],transitionDuration:500,transitionInterpolator:new k.a});this.setState({viewport:i})}}},{key:"_renderTooltip",value:function(e){var t=e.x,n=e.y,a=e.object;a?this.setState({tooltip:r.a.createElement(Fe,Object.assign({},this.state.tooltipColumns,{isMobile:Object(j.q)(),topx:t,topy:n,hoveredObject:a}))}):this.setState({tooltip:""})}},{key:"_updateURL",value:function(e){var t=this,n=e.latitude,a=e.longitude,r=e.zoom,i=e.bearing,o=e.pitch,l=e.altitude,c=this.state,s=c.subsetBoundsChange,u=c.lastViewPortChange;new Date-u>1e3&&(Pe.push("/?lat=".concat(n.toFixed(3))+"&lng=".concat(a.toFixed(3))+"&zoom=".concat(r.toFixed(2))+"&bea=".concat(i)+"&pit=".concat(o)+"&alt=".concat(l)),this.setState({lastViewPortChange:new Date}));var d=this.map&&this.map.getBounds();if(d&&s){var f=Object(j.l)(d),m=f.xmin,p=f.ymin,h=f.xmax,g=f.ymax;Object(j.h)(Re+m+"/"+p+"/"+h+"/"+g,(function(e,n){n||(t.setState({data:e.features}),t._generateLayer())}))}}},{key:"render",value:function(){var e=this,t=this.state,n=t.tooltip,a=t.viewport,i=t.initialViewState,o=t.loading,l=t.mapStyle,c=t.alert,s=t.data,u=t.filtered,d=t.layerStyle,f=t.geomType,m=t.legend,p=t.coords;return r.a.createElement("div",{id:"html2pdf"},r.a.createElement("div",{className:"loader",style:{zIndex:o?999:-1,visibility:"string"===typeof l&&l.endsWith("No map-v9")?"hidden":"visible"}}),r.a.createElement(k.c,{ref:function(t){e.map=t&&t.getMap()},mapStyle:l,onViewportChange:function(t){e._updateURL(t),e.setState({viewport:t})},height:this.state.height-54+"px",width:this.state.width+"px",viewState:a||i},r.a.createElement("div",{className:"mapboxgl-ctrl-top-right",style:{zIndex:9}},r.a.createElement(k.b,Object.assign({},a,{onViewportChange:function(t){return e.setState({viewport:t})}}))),r.a.createElement(E.a,{viewState:a||i,initialViewState:i,layers:this.state.layers,onClick:function(t){!t.layer&&p&&(e.setState({coords:null}),e._generateLayer())}},n)),r.a.createElement(Ne,{dark:this.props.dark,layerStyle:d,isMobile:Object(j.q)(),key:"decksidebar",alert:c,unfilteredData:s&&s.features,data:u,colourCallback:function(t){return e._generateLayer({cn:t})},urlCallback:function(t,n){if(e.setState({tooltip:"",road_type:"",radius:100,elevation:4,loading:!0,coords:null}),n)try{e.setState({data:n}),e._fitViewport(n),e._generateLayer()}catch(a){e._fetchAndUpdateState(void 0,{content:a.message})}else e._fetchAndUpdateState(t)},column:this.state.column,onSelectCallback:function(t){return e._generateLayer({filter:t})},onChangeRadius:function(t){return e._generateLayer({radius:t})},onChangeElevation:function(t){return e._generateLayer({elevation:t})},toggleSubsetBoundsChange:function(t){e.setState({loading:!0,subsetBoundsChange:t}),e._fetchAndUpdateState()},onlocationChange:function(t){e._fitViewport(void 0,t)},showLegend:function(t){return e.setState({legend:t})},datasetName:Re}),m&&("polygon"===f||"multipolygon"===f)&&r.a.createElement("div",{className:"right-side-panel mapbox-legend"},m))}}]),n}(r.a.Component),De=n(2051),Ve=n(997),Ue=n(1013),He=n(2042),We=n(2064),Be=[{key:1,to:"fui",title:"DUI"},{key:2,to:"about",title:"About"}];var Ye=Object(We.a)((function(e){var t=Object(a.useState)(e.dark),n=Object(l.a)(t,2),i=n[0],o=n[1];return r.a.createElement(De.a,{inverse:i,collapseOnSelect:!0},r.a.createElement(De.a.Header,null,r.a.createElement(De.a.Brand,null,r.a.createElement(He.a,{to:"/"},r.a.createElement("svg",{className:"logo",viewBox:"0 0 1025 428",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink"},Object(j.a)(i)))),r.a.createElement(De.a.Toggle,null)),r.a.createElement(De.a.Collapse,null,r.a.createElement(Ve.a,null,Be.map((function(t,n){return r.a.createElement(Ue.a,{key:n,eventKey:t.key,onClick:function(){return e.history.push(t.to)}},t.title)}))),r.a.createElement(Ve.a,{pullRight:!0},r.a.createElement(Ue.a,{href:"https://github.com/layik/eAtlas"},r.a.createElement("i",{style:{fontSize:"1.5em"},className:"fa fa-github"}))),r.a.createElement(Ve.a,{pullRight:!0},r.a.createElement(Ue.a,{onClick:function(){"function"===typeof e.toggleTheme&&e.toggleTheme(),o(!i)}},r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24","aria-hidden":"true"},r.a.createElement("g",{transform:"matrix( 1 0 0 1 4 1 )"},r.a.createElement("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.3999 11C15.7999 10.1 16 9 16 8C16 3.6 12.4 0 8 0C3.6 0 0 3.6 0 8C0 9.1 0.200098 10.1 0.600098 11L2.19995 15L13.8 15L15.3999 11ZM11 22L12.6001 18L3.3999 18L5 22L11 22Z",fill:i?"#fff":"#000",opacity:"1"})))))))})),Ge=n(1001),Ke=n.n(Ge),qe=function(e){Object(v.a)(a,e);var t=Object(b.a)(a);function a(){var e;Object(h.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={markdown:null},e}return Object(g.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=n(2004);fetch(t).then((function(e){return e.text()})).then((function(t){e.setState({markdown:Ke()(t)})}))}},{key:"render",value:function(){var e=this.state.markdown;return r.a.createElement("section",{style:{background:"white",padding:"5%"}},r.a.createElement("article",{dangerouslySetInnerHTML:{__html:e}}))}}]),a}(a.Component),Ze=function(e){Object(v.a)(n,e);var t=Object(b.a)(n);function n(){var e;Object(h.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={component:null},e}return Object(g.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.load().then((function(t){e.setState((function(){return{component:t.default?t.default:t}}))}))}},{key:"render",value:function(){return this.props.children(this.state.component)}}]),n}(a.Component),Xe=new m.a,Je=function(e){return r.a.createElement(Ze,{load:function(){return n.e(3).then(n.bind(null,2068))}},(function(t){return null===t?r.a.createElement("div",{className:"loader",style:{zIndex:999}}):r.a.createElement(t,e)}))};var Qe=function(){var e=Object(a.useState)(!0),t=Object(l.a)(e,2),n=t[0],i=t[1];return r.a.createElement(u.a,{basename:"/eAtlas"},r.a.createElement("main",{style:{background:n?"#242730":"white",margin:"auto",color:n?"#a3a5a8":"black"}},r.a.createElement(Ye,{dark:n,toggleTheme:function(){return i(!n)}}),r.a.createElement(d.Provider,{value:Xe},r.a.createElement(f.BaseProvider,{theme:n?f.DarkTheme:f.LightTheme},r.a.createElement(c.a,null,r.a.createElement(s.a,{exact:!0,path:"/",component:function(e){return r.a.createElement(Ie,Object.assign({},e,{dark:n}))}}),r.a.createElement(s.a,{exact:!0,path:"/fui",component:function(e){return r.a.createElement(Je,Object.assign({},e,{dark:n}))}}),r.a.createElement(s.a,{exact:!0,path:"/about",component:qe}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Qe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},23:function(e,t,n){"use strict";var a=n(215),r=n(1),i=n.n(r),o=n(2067),l=n(1011),c=n(2047),s=n(2056),u=n(2052),d=n(2062),f=n(2050),m=n(2055),p=n(2048),h=n(2035),g=n(277),y=n.n(g),v=n(976),b=n(86),E=n.n(b),k=n(49),C=n(56),O=n(57),w=n(67),j=n(68),S=n(2034),x=n(1009),L=n(1008);var _=function(e){Object(w.a)(n,e);var t=Object(j.a)(n);function n(){return Object(C.a)(this,n),t.apply(this,arguments)}return Object(O.a)(n,[{key:"shouldUpdateState",value:function(e){return e.changeFlags.somethingChanged}},{key:"updateState",value:function(e){var t=e.props,n=e.oldProps,a=e.changeFlags.dataChanged||t.sizeScale!==n.sizeScale;if(a){var r=new L.a({maxZoom:16,radius:t.sizeScale});r.load(t.data.map((function(e){return{geometry:{coordinates:t.getPosition(e)},properties:e}}))),this.setState({index:r})}var i=Math.floor(this.context.viewport.zoom);(a||i!==this.state.z)&&this.setState({data:this.state.index.getClusters([-180,-85,180,85],i),z:i})}},{key:"getPickingInfo",value:function(e){var t=e.info,n=e.mode,a=t.object&&t.object.properties;return a&&(a.cluster&&"hover"!==n&&(t.objects=this.state.index.getLeaves(a.cluster_id,25).map((function(e){return e.properties}))),t.object=a),t}},{key:"renderLayers",value:function(){var e=this.state.data,t=this.props,n=t.iconAtlas,a=t.iconMapping,r=t.sizeScale;return new x.a(this.getSubLayerProps({id:"icon",data:e,iconAtlas:n,iconMapping:a,sizeScale:r,getPosition:function(e){return e.geometry.coordinates},getIcon:function(e){return 0===(t=e.properties.cluster?e.properties.point_count:1)?"":t<10?"marker-".concat(t):t<100?"marker-".concat(Math.floor(t/10),"0"):"marker-100";var t},getSize:function(e){return t=e.properties.cluster?e.properties.point_count:1,Math.min(100,t)/100+1;var t}}))}}]),n}(S.a),M=n(2063),N=n(596),A=n(597),P=n(217),z=n(612),F=n(970),R=n(427),T=n(337),I=n(1005),D=n(979),V=function(e){Object(w.a)(n,e);var t=Object(j.a)(n);function n(){return Object(C.a)(this,n),t.apply(this,arguments)}return Object(O.a)(n,[{key:"getShaders",value:function(){return Object(A.a)(Object(P.a)(n.prototype),"getShaders",this).call(this,{vs:"\n  attribute vec3 positions;\n  attribute vec3 instancePositions;\n  attribute vec3 instancePositions64Low;\n  attribute float instanceRadius;\n  attribute vec4 instanceColors;\n  attribute float instanceScale;\n  attribute float instanceRotationAngle;\n  attribute float instanceWidth;\n  // for onHover to work must\n  // delcare instancePickingColors here and assign it to\n  // geometry.pickingColor\n  // and then register DECKGL_FILTER_COLOR hook in\n  // fragment shader\n  attribute vec3 instancePickingColors;\n\n  varying vec4 vColor;\n  varying vec2 vPosition;\n\n  vec2 rotate_by_angle(vec2 vertex, float angle) {\n    float angle_radian = angle * PI / 180.0;\n    float cos_angle = cos(angle_radian);\n    float sin_angle = sin(angle_radian);\n    mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n    return rotationMatrix * vertex;\n  }\n\n  void main(void) {\n    geometry.pickingColor = instancePickingColors;\n\n    vec3 offsetCommon = positions * project_size(instanceRadius);\n    offsetCommon = vec3(rotate_by_angle(offsetCommon.xy, instanceRotationAngle), 0);\n    offsetCommon.x = offsetCommon.x * instanceWidth;\n    // width first\n    offsetCommon = offsetCommon * instanceScale;\n    \n    vec3 positionCommon = project_position(instancePositions, instancePositions64Low);\n    // missx: So in your shader, positionCommon is the anchor position on the map. \n    // offsetCommon is the local coordinate relative to the anchor\n    // You want to leave the anchor alone and rotate the offset\n\n    gl_Position = project_common_position_to_clipspace(vec4(positionCommon + offsetCommon, 1.0));\n\n    vPosition = positions.xy;\n    vColor = instanceColors;\n    DECKGL_FILTER_COLOR(vColor, geometry);\n\n  }",fs:"\n  precision highp float;\n\n  uniform float smoothRadius;\n\n  varying vec4 vColor;\n  varying vec2 vPosition;\n\n  void main(void) {    \n    float distToCenter = length(vPosition);\n\n    if (distToCenter > 1.0) {\n      discard;\n    }\n\n    float alpha = smoothstep(1.0, 1.0 - smoothRadius, distToCenter);\n    gl_FragColor = vec4(vColor.rgb, vColor.a * alpha);\n    DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n  }",modules:[z.a,F.a]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:T.a.DOUBLE,accessor:"getPosition"},instanceRadius:{size:1,accessor:"getRadius",defaultValue:1},instanceColors:{size:4,type:T.a.UNSIGNED_BYTE,accessor:"getColor",defaultValue:[1,0,0,255]},smoothRadius:{size:1,normalized:!0,type:T.a.UNSIGNED_BYTE,accessor:"smoothRadius",defaultValue:[1,0,0,255]},instanceScale:{size:1,accessor:"getScale",defaultValue:1},instanceRotationAngle:{size:1,accessor:"getRotationAngle",defaultValue:1},instanceWidth:{size:1,accessor:"getWidth",defaultValue:1}})}},{key:"updateState",value:function(e){var t=e.props,a=e.oldProps,r=e.changeFlags;if(Object(A.a)(Object(P.a)(n.prototype),"updateState",this).call(this,{props:t,oldProps:a,changeFlags:r}),r.extensionsChanged){var i=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(i)})}}},{key:"draw",value:function(e){var t=e.uniforms;this.state.model.setUniforms(t).setUniforms({smoothRadius:this.props.smoothRadius}).draw()}},{key:"_getModel",value:function(e){return new I.a(e,Object.assign(this.getShaders(),{id:this.props.id,geometry:new D.a({drawMode:T.a.TRIANGLE_STRIP,vertexCount:6,attributes:{positions:{size:2,value:new Float32Array([-.1,-1,.1,-1,-.1,1,-.1,1,.1,1,.1,-1])}}}),isInstanced:!0}))}}]),n}(R.a);V.layerName="BarLayer",V.defaultProps={getPosition:{type:"accessor",value:function(e){return e.position}},getRadius:{type:"accessor",value:30},getColor:{type:"accessor",value:[0,0,0,255]},smoothRadius:{type:"number",min:0,value:.5},getScale:{type:"accessor",value:1},getRotationAngle:{type:"accessor",value:1},getWidth:{type:"accessor",value:1}};var U=n(426),H=n(581),W=n.n(H),B=n(269),Y=n(981),G=n.n(Y);n.d(t,"o",(function(){return Q})),n.d(t,"x",(function(){return q})),n.d(t,"w",(function(){return ee})),n.d(t,"i",(function(){return X})),n.d(t,"v",(function(){return me})),n.d(t,"d",(function(){return le})),n.d(t,"t",(function(){return se})),n.d(t,"k",(function(){return de})),n.d(t,"j",(function(){return fe})),n.d(t,"g",(function(){return J})),n.d(t,"u",(function(){return ne})),n.d(t,"e",(function(){return ce})),n.d(t,"b",(function(){return Z})),n.d(t,"s",(function(){return ae})),n.d(t,"f",(function(){return oe})),n.d(t,"h",(function(){return K})),n.d(t,"c",(function(){return ge})),n.d(t,"p",(function(){return te})),n.d(t,"q",(function(){return ie})),n.d(t,"a",(function(){return ue})),n.d(t,"l",(function(){return $})),n.d(t,"n",(function(){return he})),n.d(t,"m",(function(){return pe})),n.d(t,"r",(function(){return re}));var K=function(e,t){fetch(e).then((function(e){return e.text()})).then((function(n){if(e.endsWith("csv"))W.a.csv2geojson(n,(function(e,n){e||"function"===typeof t&&t(n)}));else try{var a=JSON.parse(n);t(a)}catch(r){t(void 0,r)}})).catch((function(e){console.error(e),t(null,e)}))},q=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e&&t){var a=new Map;e.forEach((function(e){var r=e.properties[t];if(n&&r){var i=+r?+r:r;a.get(i)?a.set(i,a.get(i)+1):a.set(i,1)}}));var r=Array.from(a.keys());if(r&&r.length)return r.sort(B.a),r.map((function(e){return{x:e,y:+a.get(e)}}))}},Z=Object(h.a)().domain([-.6,-.45,-.3,-.15,0,.15,.3,.45,.6,.75,.9,1.05,1.2]).range([[65,182,196],[127,205,187],[199,233,180],[237,248,177],[255,255,204],[255,237,160],[254,217,118],[254,178,76],[253,141,60],[252,78,42],[227,26,28],[189,0,38],[128,0,38]]),X=function(e,t,n,a){var r=function(e,t){Object.keys(e).forEach((function(n){return t[n]=e[n]}))};if("hex"===e){var i={id:"hexagon-layer",data:t,pickable:!0,extruded:!0,radius:100,elevationScale:1,getPosition:function(e){return e.geometry.coordinates},onHover:n};return r(a,i),new o.a(i)}if("hex"===e){var p={id:"scatterplot-layer",data:t,pickable:!0,opacity:.8,radiusScale:6,radiusMinPixels:1,radiusMaxPixels:100,getPosition:function(e){return e.geometry.coordinates},getRadius:function(e){return Math.sqrt(e.exits)},getColor:function(e){return[255,140,0]},onHover:n};return r(a,p),new l.a(p)}if("geojson"===e){var h={id:"geojson-layer",data:t,pickable:!0,stroked:!1,filled:!0,extruded:!0,lineWidthScale:20,lineWidthMinPixels:2,getRadius:100,getLineWidth:1,getElevation:30,onHover:n,getElevation:function(e){return 10*Math.sqrt(e.properties.valuePerSqm)}};return r(a,h),new c.a(h)}if("icon"===e){var g={id:"icon-layer",data:t,pickable:!0,iconAtlas:G.a,iconMapping:v,sizeScale:60,getPosition:function(e){return e.geometry.coordinates},wrapLongitude:!0,onHover:n};return r(a,g),new _(g)}if("sgrid"===e){var y={id:"screen_grid",data:t,getPosition:function(e){return e.geometry.coordinates},cellSizePixels:4,onHover:n};return r(a,y),new s.a(y)}if("grid"===e){var b={id:"screen_grid",data:t,pickable:!0,extruded:!0,cellSize:100,elevationScale:4,getPosition:function(e){return e.geometry.coordinates},onHover:n};return r(a,b),new u.a(b)}if("line"===e){var E={id:"line-layer",data:t,pickable:!0,onHover:n};return r(a,E),new d.a(E)}if("arc"===e){var k={id:"arc-layer",data:t,pickable:!0,onHover:n};return r(a,k),new M.a(k)}if("path"===e){var C={id:"path-layer",data:t,pickable:!0,onHover:n};return r(a,C),new N.a(C)}if("heatmap"===e){var O={id:"heatmap-layer",data:t,pickable:!0,onHover:n};return r(a,O),new f.a(O)}if("scatterplot"===e){var w={id:"scatterplot",data:t,pickable:!0,onHover:n,opacity:.3};return r(a,w),new l.a(w)}if("text"===e){var j={id:"text-layer",data:t,pickable:!0,onHover:n};return r(a,j),new m.a(j)}if("barvis"===e){var S={id:"barvis-layer",data:t,pickable:!0,onHover:n};return r(a,S),new V(S)}return null},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{oldMax:10,oldMin:1,newMax:1,newMin:0},n=(e-t.oldMin)*(t.newMax-t.newMin)/(t.oldMax-t.oldMin)+t.newMin;return+n.toFixed(2)},Q=function(e){if(!e)return null;var t=y.a.parse(e.replace("?","")),n=Number(t.lat).toFixed(3),a=Number(t.lng).toFixed(3);return{latitude:isNaN(n)?53.8321:Number(n),longitude:isNaN(a)?-1.6362:Number(a),zoom:Number(y.a.parse(e).zoom)||10,pit:Number(y.a.parse(e).pit)||55,bea:Number(y.a.parse(e).bea)||0,alt:Number(y.a.parse(e).alt)||1.5}},$=function(e){if(!e)return null;var t=e._sw.lng,n=e._ne.lng,a=e._sw.lat,r=e._ne.lat;return t>n&&(n=e._sw.lng,t=e._ne.lng),a>r&&(r=e._sw.lat,a=e._ne.lat),{xmin:t,ymin:a,xmax:n,ymax:r}},ee=function(e){var t=E.a.UI_LIST;return e?1===e?t[0]:e>3&&e<=6?t[1]:2===e||3===e?t[2]:e>9&&e<15?t[3]:t[4]:t[1]},te=function(e){if(!e)return e;for(var t=e.split("_"),n=0;n<t.length;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1);return t.join(" ")},ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:26;if(Object(k.isNumber)(e))return parseFloat(Number.parseFloat(e).toFixed(2).toString());if(!e||e.length<=t||!Object(k.isString)(e))return e;var n=e.trim(),a=e.split(".").length>1&&e.split(".").pop().length<10&&e.split(".").pop();return n.replace(a,""),e.length>10&&(n=n.substring(0,10)+"..."+(a||"")),n},ae=function(e,t,n,a){return i.a.createElement("div",{key:e,onClick:function(){return"function"===typeof n&&n()},style:{cursor:"pointer",textAlign:"center",position:"relative",float:"left",width:"30%",color:a?"white":"black",margin:"10px 2px",border:"1px solid gray"}},i.a.createElement("span",{style:{position:"absolute",left:"10%"}},e),i.a.createElement("div",{style:{width:t+"%",height:20,background:"rgb(18, 147, 154)"}}))},re=function(e){var t=document.createElement("a");return t.href=e,t.host&&t.host!==window.location.host},ie=function(){var e,t=!1;return window.innerWidth<640||(e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.substr(0,4)))&&(t=!0),t)};var oe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:180;if(!e||!Object(U.b)(n)||!n.length)return null;var i=n.indexOf(e.properties[t]),o=Object(p.a)(i/n.length);return o=o.substring(4,o.length-1).replace(/ /g,"").split(",").map((function(e){return+e})),[].concat(Object(a.a)(o),[r])},le=["inverseDefault","yellowblue","greens","oranges","diverge","default"],ce=function(e){if(e){return{yellowblue:[[255,255,204],[199,233,180],[127,205,187],[65,182,196],[44,127,184],[37,52,148]],greens:[[237,248,233],[199,233,192],[161,217,155],[116,196,118],[49,163,84],[0,109,44]],oranges:[[254,237,222],[253,208,162],[253,174,107],[253,141,60],[230,85,13],[166,54,3]],diverge:[[140,81,10],[216,179,101],[246,232,195],[199,234,229],[90,180,172],[1,102,94]],inverseDefault:[[189,0,38],[240,59,32],[253,141,60],[254,178,76],[254,217,118],[255,255,178]],default:[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]]}[e]}},se=function(e,t){K("https://nominatim.openstreetmap.org/search/"+e+"?format=json",(function(e){"function"===typeof t&&t(e)}))},ue=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return i.a.createElement("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.a.createElement("g",{id:"ATI_logo_black_ATI_logo_black_W1024px",fill:e?"#ffffff":"#000000"},i.a.createElement("g",{id:"logo-line-1","data-svg-origin":"0.8190000057220459 0.7929999828338623",transform:"matrix(1,0,0,1,0,0)",style:{zIndex:0,visibility:"inherit",opacity:1}},i.a.createElement("path",{d:"M273.346,71.521 L233.737,71.521 C235.771,58.945 242.738,52.485 253.966,52.485 C265.183,52.485 272.837,60.128 273.346,71.521 M299.694,83.932 C299.694,52.816 282.185,33.27 254.131,33.27 C226.425,33.27 207.72,52.816 207.72,81.718 C207.72,111.985 226.08,131.363 254.983,131.363 C277.938,131.363 293.744,120.479 299.529,100.424 L272.495,100.424 C269.775,107.735 263.987,111.475 255.493,111.475 C242.573,111.475 234.588,103.654 233.902,90.05 L299.529,90.05 C299.694,87.327 299.694,84.948 299.694,83.932",id:"Fill-13"}),i.a.createElement("path",{d:"M117.531,128.642 L143.027,128.642 L143.027,83.08 C143.027,63.192 148.647,53.667 160.371,53.667 C171.081,53.667 175.162,59.62 175.162,74.751 L175.162,128.642 L200.658,128.642 L200.658,72.031 C200.658,57.749 198.622,50.437 193.181,44.156 C187.738,37.861 178.392,33.78 169.209,33.78 C159.354,33.78 149.664,38.713 143.027,47.042 L143.027,0.793 L117.531,0.793 L117.531,128.642",id:"Fill-12"}),i.a.createElement("polyline",{id:"Fill-11",points:"55.645 0.796 0.819 0.796 0.819 23.242 42.3 23.242 42.3 128.632 69.158 128.632 69.158 23.242 110.474 23.242 110.474 0.796 55.645 0.796"})),i.a.createElement("g",{id:"logo-line-2",transform:"matrix(1,0,0,1,169,149)","data-svg-origin":"0.9760000109672546 0.0860000029206276",style:{zIndex:0,visibility:"inherit",opacity:1}},i.a.createElement("path",{d:"M831.16,79.656 C831.16,94.445 823.69,104.3 812.635,104.3 C801.586,104.3 794.45,94.279 794.45,78.804 C794.45,63.671 801.928,53.308 812.814,53.308 C824.03,53.308 831.16,63.506 831.16,79.656 M855.82,108.724 L855.82,35.289 L832.87,35.289 L832.87,46.848 C825.9,37.158 818.078,33.076 807.029,33.076 C784.253,33.076 768.268,52.112 768.268,78.97 C768.268,106.169 783.222,124.202 805.668,124.202 C817.571,124.202 825.05,120.451 831.85,111.281 L831.85,120.972 C831.85,137.794 826.24,145.106 813.486,145.106 C804.306,145.106 798.025,140.515 797.504,133.382 L772.173,133.382 C773.877,152.076 789.175,163.125 813.145,163.125 C835.42,163.125 849.19,154.121 853.95,136.268 C855.65,129.631 855.82,127.087 855.82,108.724",id:"Fill-22"}),i.a.createElement("path",{d:"M701.193,35.283 L676.88,35.283 L676.88,127.932 L702.389,127.932 L702.389,79.994 C702.389,61.465 707.819,52.792 719.557,52.792 C724.997,52.792 729.589,55.349 732.133,59.417 C733.836,62.482 734.346,65.547 734.346,73.534 L734.346,127.932 L759.842,127.932 L759.842,75.402 C759.842,58.91 758.825,52.957 755.085,47.007 C749.476,38.168 739.951,33.249 728.227,33.249 C716.834,33.249 707.144,38.168 701.193,46.841 L701.193,35.283",id:"Fill-21"}),i.a.createElement("path",{d:"M637.104,24.567 L662.601,24.567 L662.601,0.088 L637.104,0.088 L637.104,24.567 Z M637.104,127.938 L662.601,127.938 L662.601,35.285 L637.104,35.285 L637.104,127.938 Z",id:"Fill-20"}),i.a.createElement("path",{d:"M569.69,127.936 L595.186,127.936 L595.186,86.965 C595.186,64.189 601.991,55.339 619.334,55.339 C622.055,55.339 623.747,55.515 626.467,56.191 L626.467,34.09 C624.089,33.238 622.564,33.073 619.676,33.073 C608.106,33.073 598.926,38.172 594.004,47.352 L594.004,35.286 L569.69,35.286 L569.69,127.936",id:"Fill-19"}),i.a.createElement("path",{d:"M532.476,127.936 L556.789,127.936 L556.789,35.286 L531.28,35.286 L531.28,83.225 C531.28,93.259 530.442,98.358 527.884,102.44 C524.822,107.538 519.721,110.424 514.112,110.424 C508.672,110.424 504.08,108.048 501.536,103.798 C499.833,100.737 499.323,97.672 499.323,89.685 L499.323,35.286 L473.827,35.286 L473.827,87.816 C473.827,104.308 474.847,110.259 478.584,116.212 C484.193,125.05 493.883,129.97 505.442,129.97 C516.67,129.97 526.36,125.05 532.476,116.377 L532.476,127.936",id:"Fill-18"}),i.a.createElement("polyline",{id:"Fill-17",points:"425.87 127.936 452.728 127.936 452.728 22.531 494.041 22.531 494.041 0.086 384.389 0.086 384.389 22.531 425.87 22.531 425.87 127.936"}),i.a.createElement("path",{d:"M287.694,35.283 L263.38,35.283 L263.38,127.932 L288.89,127.932 L288.89,79.994 C288.89,61.465 294.319,52.792 306.057,52.792 C311.498,52.792 316.089,55.349 318.633,59.417 C320.336,62.482 320.846,65.547 320.846,73.534 L320.846,127.932 L346.342,127.932 L346.342,75.402 C346.342,58.91 345.325,52.957 341.585,47.007 C335.977,38.168 326.452,33.249 314.728,33.249 C303.334,33.249 293.644,38.168 287.694,46.841 L287.694,35.283",id:"Fill-16"}),i.a.createElement("path",{d:"M226.718,85.77 C226.718,102.428 219.24,111.952 206.144,111.952 C197.991,111.952 192.206,107.364 192.206,101.08 C192.206,93.934 198.501,90.362 214.472,87.818 L223.322,86.456 C223.653,86.28 224.849,86.115 226.718,85.77 M250.687,87.473 C250.852,80.671 250.852,76.59 250.852,74.553 C250.852,57.388 248.818,50.077 241.851,43.272 C235.046,36.305 224.339,32.565 210.912,32.565 C186.088,32.565 170.448,44.468 169.254,64.356 L195.436,64.356 C195.944,55.175 201.221,50.584 211.419,50.584 C221.961,50.584 226.552,56.192 226.718,69.278 C215.5,69.964 200.37,72.177 192.041,74.388 C174.353,78.635 165.68,87.818 165.68,101.92 C165.68,118.413 179.451,129.971 199.353,129.971 C214.307,129.971 223.653,125.049 230.457,113.656 L230.457,117.396 C230.457,120.967 230.623,122.839 231.309,127.937 L253.244,127.937 C251.373,120.116 250.687,110.935 250.687,96.147 L250.687,87.473",id:"Fill-15"}),i.a.createElement("polygon",{id:"Fill-14",points:"130.939 127.937 156.435 127.937 156.435 0.087 130.939 0.087"}),i.a.createElement("path",{d:"M79.347,73.37 L45.508,73.37 L62.51,20.319 L79.347,73.37 Z M125.075,127.937 L80.529,0.087 L45.343,0.087 L0.976,127.937 L28.341,127.937 L38.541,96.311 L86.659,96.311 L97.024,127.937 L125.075,127.937 Z",id:"Fill-1"})),i.a.createElement("g",{id:"logo-line-3",transform:"matrix(1,0,0,1,24,297)","data-svg-origin":"0.7670000195503235 0.34700000286102295",style:{zIndex:0,visibility:"inherit",opacity:1}},i.a.createElement("path",{d:"M592.476,71.073 L552.866,71.073 C554.9,58.497 561.868,52.037 573.096,52.037 C584.313,52.037 591.966,59.68 592.476,71.073 M618.824,83.484 C618.824,52.368 601.315,32.822 573.261,32.822 C545.552,32.822 526.849,52.368 526.849,81.273 C526.849,111.537 545.21,130.915 574.113,130.915 C597.068,130.915 612.874,120.031 618.659,99.976 L591.625,99.976 C588.902,107.29 583.117,111.028 574.623,111.028 C561.702,111.028 553.718,103.206 553.032,89.602 L618.659,89.602 C618.824,86.879 618.824,84.501 618.824,83.484",id:"Fill-10"}),i.a.createElement("path",{d:"M521.303,35.543 L506.348,35.543 L506.348,13.1 L480.839,13.1 L480.839,35.543 L467.246,35.543 L467.246,54.758 L480.839,54.758 L480.839,97.256 C480.839,109.501 481.858,114.765 485.43,120.029 C490.187,127.175 497.168,130.24 508.548,130.24 C513.826,130.24 516.546,129.898 521.303,128.702 L521.303,109.666 C518.238,110.008 517.221,110.173 516.039,110.173 C509.058,110.173 506.348,106.271 506.348,96.236 L506.348,54.758 L521.303,54.758 L521.303,35.543",id:"Fill-9"}),i.a.createElement("path",{d:"M434.281,128.196 L458.595,128.196 L458.595,35.546 L433.085,35.546 L433.085,83.485 C433.085,93.52 432.247,98.618 429.69,102.7 C426.625,107.799 421.527,110.684 415.918,110.684 C410.478,110.684 405.886,108.308 403.342,104.061 C401.639,100.997 401.129,97.932 401.129,89.945 L401.129,35.546 L375.633,35.546 L375.633,88.076 C375.633,104.568 376.65,110.519 380.39,116.472 C385.998,125.31 395.689,130.23 407.247,130.23 C418.476,130.23 428.163,125.31 434.281,116.637 L434.281,128.196",id:"Fill-8"}),i.a.createElement("path",{d:"M364.433,35.543 L349.479,35.543 L349.479,13.1 L323.969,13.1 L323.969,35.543 L310.376,35.543 L310.376,54.758 L323.969,54.758 L323.969,97.256 C323.969,109.501 324.989,114.765 328.56,120.029 C333.317,127.175 340.298,130.24 351.678,130.24 C356.956,130.24 359.676,129.898 364.433,128.702 L364.433,109.666 C361.368,110.008 360.351,110.173 359.169,110.173 C352.188,110.173 349.479,106.271 349.479,96.236 L349.479,54.758 L364.433,54.758 L364.433,35.543",id:"Fill-7"}),i.a.createElement("path",{d:"M288.764,0.347 L276.009,0.347 L276.009,24.823 L301.519,24.823 L301.519,0.347 L288.764,0.347 Z M288.764,35.533 L276.009,35.533 L276.009,128.197 L301.519,128.197 L301.519,35.533 L288.764,35.533 Z",id:"Fill-6"}),i.a.createElement("path",{d:"M265.918,35.543 L250.964,35.543 L250.964,13.1 L225.454,13.1 L225.454,35.543 L211.862,35.543 L211.862,54.758 L225.454,54.758 L225.454,97.256 C225.454,109.501 226.474,114.765 230.046,120.029 C234.803,127.175 241.784,130.24 253.164,130.24 C258.441,130.24 261.162,129.898 265.918,128.702 L265.918,109.666 C262.854,110.008 261.837,110.173 260.654,110.173 C253.673,110.173 250.964,106.271 250.964,96.236 L250.964,54.758 L265.918,54.758 L265.918,35.543",id:"Fill-5"}),i.a.createElement("path",{d:"M207.476,65.123 C207.641,44.891 193.194,32.825 168.373,32.825 C144.404,32.825 129.105,44.384 129.105,62.238 C129.105,69.029 131.991,75.83 137.092,80.422 C142.877,85.697 148.993,88.076 165.995,91.65 C178.57,94.359 183.162,97.421 183.162,103.209 C183.162,108.638 177.553,112.213 169.059,112.213 C158.341,112.213 152.732,107.111 152.909,97.256 L126.892,97.256 C127.236,118.849 142.367,130.918 168.883,130.918 C194.048,130.918 209.689,119.357 209.689,100.83 C209.689,86.714 201.36,78.209 182.997,73.452 L164.633,68.698 C157.666,66.826 154.601,64.272 154.601,60.19 C154.601,54.581 159.369,51.186 167.356,51.186 C177.719,51.186 181.98,55.091 182.487,65.123 L207.476,65.123",id:"Fill-4"}),i.a.createElement("path",{d:"M61.442,35.543 L37.128,35.543 L37.128,128.192 L62.638,128.192 L62.638,80.254 C62.638,61.725 68.068,53.055 79.806,53.055 C85.246,53.055 89.838,55.609 92.381,59.68 C94.085,62.742 94.594,65.807 94.594,73.794 L94.594,128.192 L120.091,128.192 L120.091,75.662 C120.091,59.17 119.074,53.22 115.334,47.267 C109.725,38.428 100.2,33.509 88.476,33.509 C77.083,33.509 67.392,38.428 61.442,47.102 L61.442,35.543",id:"Fill-3"}),i.a.createElement("polyline",{id:"Fill-2",points:"13.508 0.347 0.767 0.347 0.767 128.197 26.249 128.197 26.249 0.347 13.508 0.347"}))))},de=function(e){var t=e.domain,n=e.interpolate,a=void 0===n?p.a:n,r=e.title;if(t&&Array.isArray(t)&&Object(k.isNumber)(t[0])){for(var o=t[t.length-1],l=t[0],c=[i.a.createElement("p",{key:"title"},r)],s=0;s<10;s+=1)c.push(i.a.createElement(i.a.Fragment,null,0===s&&i.a.createElement("i",null,(r===te("Mean.Travel.Time..Seconds.")?+l/300:l).toFixed(2)),i.a.createElement("span",{key:s,style:{background:a(s/10)}}),9===s&&i.a.createElement("i",null,(r===te("Mean.Travel.Time..Seconds.")?+o/300:o).toFixed(2))));return c}},fe=function(e,t){if(e&&Array.isArray(e)&&t&&e.length){var n=!0,a=[];return e.forEach((function(e){var r=e.properties[Object(k.isNumber)(t)?Object.keys(e.properties)[t]:t];r&&(Object(k.isNumber)(r)&&"Mean.Travel.Time..Seconds."===t?a.push(Math.floor(r/300)):Object(k.isNumber)(r)?a.push(+r):(n=!1,a.push(r)))})),a=Array.from(new Set(a)),n&&(a=a.sort((function(e,t){return e-t}))),a}},me=function(e){var t=!0;return e.map((function(e){return!Object(k.isNumber)(e)&&(t=!1)})),t&&(e=e.sort((function(e,t){return e-t}))),e},pe=function(e){return e.reduce((function(e,t){return e>=t?e:t}),-1/0)},he=function(e){return e.reduce((function(e,t){return e<=t?e:t}),1/0)},ge={version:8,sources:{"simple-tiles":{type:"raster",tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.jpg"],tileSize:256}},layers:[{id:"simple-tiles",type:"raster",source:"simple-tiles"}]}},421:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(215),r=n(276),i=n(39),o=n(1),l=n.n(o),c=n(61),s=n(2017),u=n(23),d=n(86),f=d.PLOT_W,m=Object(c.n)(c.l);function p(e){var t=Object(o.useState)(),n=Object(i.a)(t,2),d=n[0],p=n[1],h=Object(o.useState)(null),g=Object(i.a)(h,2),y=g[0],v=g[1],b=Object(o.useState)(null),E=Object(i.a)(b,2),k=E[0],C=E[1],O=Object(o.useState)(null),w=Object(i.a)(O,2),j=w[0],S=w[1],x=Object(o.useState)(null),L=Object(i.a)(x,2),_=L[0],M=L[1],N=Object(o.useState)(null),A=Object(i.a)(N,2),P=A[0],z=A[1],F=Object(o.useState)([]),R=Object(i.a)(F,2),T=R[0],I=R[1],D=e.type;if(!D)return null;var V=e.type!==c.h&&!e.noLimit&&e.data&&e.data.length>10?e.data.slice(0,10):e.data,U=e.plotStyle,H=e.title,W=e.noXAxis,B=e.noYAxis,Y=e.onValueClick,G=e.onDragSelected;if(!V||!V.length)return null;var K=V.map((function(e,t){return Object(r.a)(Object(r.a)({},e),{},{color:V.length===T.length?0:Number(!T.includes(t))})}));return l.a.createElement("div",{className:"unselectable",style:{position:"relative"},onMouseDown:function(e){y||k||(v(e.clientX),C(e.clientY))},onMouseMove:function(e){if(y&&k){var t=e.clientX,n=e.clientY;S(t),M(n),z(l.a.createElement("div",{style:{position:"fixed",left:y>t?t:y,top:k>_?n:k,width:Math.abs(t-y),height:Math.abs(n-k),backgroundColor:"gray",opacity:.2}}))}},onMouseUp:function(e){v(null),C(null),S(null),M(null),z(null),P&&"function"===typeof G&&G(T.map((function(e){return K[e]&&K[e].x}))),I([])},onMouseOut:function(){P||I([])}},e.type!==c.h&&!e.noLimit&&e.data&&e.data.length>10&&l.a.createElement("h4",null,"Plotting first ",10," values:"),B&&H&&l.a.createElement("h4",null,H),l.a.createElement(m,{xType:"ordinal",margin:{bottom:U&&U.marginBottom||40},animation:{duration:1},height:U&&U.height||f,width:U&&U.width||f,onMouseLeave:function(){p(!1)}},!W&&l.a.createElement(c.k,{tickSize:0,tickFormat:function(e){return Object(u.u)(e,10)},tickValues:V.length>10?V.filter((function(e,t){if(t%Math.floor(V.length/10)===0)return e.x})).map((function(e){return e.x})):V.map((function(e){return e.x})),position:"right",tickLabelAngle:-65,style:{line:{strokeWidth:0},text:{fill:e.dark?"#fff":"#000"}}}),!B&&l.a.createElement(c.m,{tickSize:0,tickLabelAngle:-45,tickFormat:function(e){return Object(s.a)(".2s")(e)},style:{line:{strokeWidth:0},title:{fill:e.dark?"#fff":"#000"},text:{fill:e.dark?"#fff":"#000"}},position:"start",title:H}),l.a.createElement(D,{onValueClick:Y,onNearestX:function(e,t){var n=t.index,r=t.innerX;p({x:e.x,y:e.y}),P&&function(e){var t=e.x,n=e.x1,a=e.value;return n>t?a>t&&a<n:a<t&&a<n}({x:y,x1:j,value:r})?T.includes(n)||I([].concat(Object(a.a)(T),[n])):P||I([n])},colorDomain:[0,1],colorRange:["rgb(239, 93, 40)","rgb(18, 147, 154)"],data:K}),d&&l.a.createElement(c.d,{value:d})),y&&j&&P)}},49:function(e,t){var n=function(e){return null!==e&&void 0!==e&&e.constructor===String},a=function(e){return null!==e&&void 0!==e&&e.constructor===Number},r=function(e){return null!==e&&void 0!==e&&e.constructor===Boolean};t.isString=n,t.isNumber=a,t.isBoolean=r,t.isObject=function(e){return null!==e&&void 0!==e&&e.constructor===Object},t.isArray=function(e){return null!==e&&void 0!==e&&e.constructor===Array},t.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t.sanitizeFloat=function(e){if(a(e))return e;if(n(e)){var t=parseFloat(e);return isNaN(t)?null:t}return null},t.sanitizeInt=function(e){return a(e)?e:n(e)?parseInt(e):null},t.sanitizeString=function(e){return n(e)?e:a(e)?e.toString():null},t.sanitizeStringNonNull=function(e){return n(e)?e:a(e)?e.toString():""},t.sanitizeBool=function(e){return r(e)?e:a(e)?Boolean(e):null},t.isEmptyOrSpaces=function(e){return null===e||null!==e.match(/^ *$/)}},585:function(e,t){},622:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(56),r=n(57),i=n(67),o=n(68),l=n(1),c=n(983),s=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={progressAmount:0},e.handleDrop=function(t,n){var a=e.props.contentCallback,r=t[0];if(!r.type||r.type.match(/text.*/)||r.type.match(/geo/)||r.type.match(/json/)){var i=new FileReader;i.onload=function(t){e.setState({progressAmount:100}),e.reset();var n=i.result;"function"===typeof a&&a({text:n,name:r.name})},i.readAsText(r)}else e.setState({progressAmount:100}),e.reset(),console.log("File not supported!");e.startProgress()},e.startProgress=function(){e.intervalId=setInterval((function(){e.state.progressAmount>=100?e.reset():e.setState({progressAmount:e.state.progressAmount+10})}),500)},e.reset=function(){clearInterval(e.intervalId),e.setState({progressAmount:0})},e}return Object(r.a)(n,[{key:"render",value:function(){return l.createElement("center",{className:"file-upload"},l.createElement(c.FileUploader,{onCancel:this.reset,onDrop:this.handleDrop,progressAmount:this.state.progressAmount,progressMessage:this.state.progressAmount&&"Uploading... ".concat(this.state.progressAmount,"% of 100%")}))}}]),n}(l.Component)},636:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(39),r=n(1),i=n.n(r),o=n(2016),l=n(1014),c=n(2019),s=n(590),u=n(23);function d(e){var t=e.urlCallback,n=Object(r.useState)("https://domain.com/api/stats19"),d=Object(a.a)(n,2),f=d[0],m=d[1];return i.a.createElement("form",{onKeyPress:function(e){13===e.which&&(e.preventDefault(),Object(u.r)(f)&&"function"===typeof t&&t(f))},className:"search-form"},i.a.createElement(o.a,null,i.a.createElement(l.a,null,i.a.createElement(c.a,{onChange:function(e){var t=e.target.value;m(t)},style:{background:e.dark?"#242730":"white",color:e.dark?"white":"black"},value:f,placeholder:f,type:"text"}),i.a.createElement(l.a.Addon,{style:{background:e.dark?"#242730":"white",color:e.dark?"white":"black"}},i.a.createElement(s.a,{glyph:"globe"})))))}},690:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(39),r=n(1),i=n.n(r),o=(n(1180),n(23)),l=n(49),c=n(106),s=n(169),u=n(168);function d(e){var t=e.onSelectCallback,n=e.multiVarSelect,d=e.unfilteredData,f=Object(r.useState)(n&&Object.keys(n)),m=Object(a.a)(f,2),p=m[0],h=m[1];if(!d||!d[0])return null;if(d&&0===Object.keys(d[0].properties).filter((function(e){return!Object(l.isEmptyOrSpaces)(e)})).length)return i.a.createElement("h3",null,"There are no columns to inspect or filter.");var g=Object(c.b)(d[0]),y=Object.keys(d[0].properties).filter((function(e){return"date"!==e})).map((function(e){return{id:Object(o.p)(e)+" ["+g[e].name+"]",value:e}})),v=Array.from(new Set(p.map((function(e){return e.value})).concat(Object.keys(n).filter((function(e){return"date"!==e})))));return v=v.map((function(e){return{id:Object(o.p)(e)+" ["+g[e].name+"]",value:e}})),i.a.createElement("div",{style:e.style},"Column to filter:",i.a.createElement(s.Select,{labelKey:"id",valueKey:"value",placeholder:"Chose column ("+y.length+")",maxDropdownHeight:"300px",type:s.TYPE.search,multi:!0,onChange:function(e){var a=e.value,r=a.map((function(e){return e.value}));Object.keys(n).map((function(e){r.includes(e)||delete n[e]})),"function"===typeof t&&t(n),h(a)},value:v,options:y}),v&&v.map((function(e){return e.value})).map((function(e){var a=[];return d.forEach((function(t){return Object.keys(t.properties).forEach((function(n){return n===e&&t.properties[e]&&!a.includes(t.properties[e])&&a.push(t.properties[e])}))})),i.a.createElement(i.a.Fragment,null,Object(o.p)(e),i.a.createElement(u.a,{title:"Available ("+a.length+")",filter:e,multiVarSelect:n,values:a.map((function(e){return{id:e+"",value:e+""}})),onSelectCallback:function(e){"function"===typeof t&&t(e.selected||{})},value:n[e]&&Array.from(n[e]).map((function(e){return{id:e+"",value:e+""}}))}))})))}},691:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(39),r=n(1),i=n.n(r),o=n(420),l=n(592),c=n(23);function s(e){var t=i.a.useState(1),n=Object(a.a)(t,2),r=n[0],s=n[1],u=e.data;if(!u||0===u.length)return null;var d=Math.floor(u.length/10),f=Object.keys(u[0].properties).map((function(e){return Object(c.p)(e)})),m=u.slice(10*r,10*r+10).map((function(e){return Object.keys(e.properties).map((function(t){return e.properties[t]}))}));return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.Pagination,{numPages:d,currentPage:r,onPageChange:function(e){var t=e.nextPage;s(Math.min(Math.max(t,1),d))}}),i.a.createElement(o.Table,{columns:f,data:m}),i.a.createElement(l.Pagination,{numPages:d,currentPage:r,onPageChange:function(e){var t=e.nextPage;s(Math.min(Math.max(t,1),d))}}))}},701:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(56),r=n(57),i=n(67),o=n(68),l=n(1),c=n.n(l),s=n(186),u=n(991),d=n(51),f=n(992),m=n(169),p=n(23),h=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={checks:[]},r}return Object(r.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.title,a=t.sublist,r=t.suggested,i=t.onChange,o=t.steps;if(!n||!a||0===a.length)return null;var l=this.state.checks,h=r||Object(p.w)(a.length),g=null;if("checkbox"===h)g=c.a.createElement(c.a.Fragment,null,a.map((function(t,n){return c.a.createElement(u.Checkbox,{key:t,checked:e.state.checks[n],value:t,onChange:function(){l[n]=!l[n],e.setState({checks:l})}},t)})));else if("slider"===h&&parseInt(a[0])){var y=a;g=c.a.createElement(c.a.Fragment,null,c.a.createElement(s.Slider,{value:this.state.value||[y[0]],min:parseInt(y[0]),max:parseInt(y[y.length-1]),step:o||1,onChange:function(t){var n=t.value;e.setState({value:n}),"function"===typeof i&&i(n[0])}}),n)}else g="buttongroups"===h?c.a.createElement(c.a.Fragment,null,"Checkbox Mode StatefulButtonGroup",c.a.createElement(f.StatefulButtonGroup,{mode:"checkbox",initialState:{selected:[0]}},a.map((function(e,t){return c.a.createElement(d.Button,{key:e+"-"+t,value:e,onClick:function(e){return console.log(e.target.value)}},e)})))):c.a.createElement(m.StatefulSelect,{options:a.map((function(e){return{id:e}})),labelKey:"id",placeholder:"Choose "+Object(p.p)(n),type:m.TYPE.search,onChange:function(e){return console.log(e&&e.value[0]&&e.value[0].id)}});return g}}]),n}(c.a.Component)},86:function(e,t){function n(e,n){Object.defineProperty(t,e,{value:n,enumerable:!0})}n("PRD_URL","https://layik.github.io/eAtlas"),n("DEV_URL","http://localhost:8000"),n("UI_LIST",["checkbox","radio","buttongroups","dropdown","slider"]),n("LAYERSTYLES",["arc","geojson","grid","heatmap","hex","icon","line","path","scatterplot","sgrid","barvis"]),n("DECKGL_INIT",{longitude:-1.6362,latitude:53.8321,zoom:10,pitch:55,bearing:0}),n("LIGHT_SETTINGS",{lightsPosition:[-.144528,49.739968,8e3,-3.807751,54.104682,8e3],ambientRatio:.4,diffuseRatio:.6,specularRatio:.2,lightsStrength:[.8,0,.8,0],numberOfLights:2}),n("PLOT_W",250),n("TURQUOISE_RANGE",["#12939A","#1293FF"])},964:function(e,t,n){},969:function(e,t,n){"use strict";var a=n(215),r=n(39),i=n(1),o=n.n(i),l=n(51),c=n(593),s=n(61),u=n(168),d=n(86),f=Object(s.n)(s.i),m=d.PLOT_W;function p(e){var t=Object(i.useState)(!1),n=Object(r.a)(t,2),a=n[0],l=n[1],c=e.data,s=e.plotStyle,u=e.title,d={animation:{damping:9,stiffness:300},data:c,onLeafMouseOver:function(e){return l({hoveredNode:e})},onLeafMouseOut:function(){return l({hoveredNode:!1})},mode:"squarify",getLabel:function(e){return e.name},width:s&&s.width||m+50,height:s&&s.height||m};return c&&0!==c.length?o.a.createElement("div",{className:"dynamic-treemap-example"},o.a.createElement("h6",null,u),o.a.createElement(f,d),a&&a.value):null}var h=n(23),g=n(49),y=n(421);n.d(t,"a",(function(){return E}));var v=["Vertical Bar","Horizontal Bar","Line","Pop. Pyramid","Treemap"];function b(e,t,n,a,r,i){if(e&&0!==e.length&&Object(g.isString)(t)&&Object(g.isString)(n)){var l=Object(h.x)(e,t);return"Treemap"===n?o.a.createElement(p,{plotStyle:a,data:{title:t+" "+n,color:1,children:l.map((function(t,n){return{name:t.x,size:+t.y/e.length,color:Object(g.isNumber)(t.x)||n,style:{border:"thin solid red"}}}))},title:Object(h.p)(t)}):n.startsWith("Vertical")||n.startsWith("Horizontal")||n.startsWith("Line")?o.a.createElement(y.a,{dark:i,noLimit:r,plotStyle:a,data:l,type:n.startsWith("Vertical")?s.j:n.startsWith("Horizontal")?s.e:s.g,title:Object(h.p)(t),noYAxis:!0}):void 0}}function E(e){var t=Object(i.useState)(!1),n=Object(r.a)(t,2),s=n[0],d=n[1],f=Object(i.useState)(!1),m=Object(r.a)(f,2),p=m[0],g=m[1],y=Object(i.useState)([]),E=Object(r.a)(y,2),k=E[0],C=E[1],O=e.data,w=e.onSelectCallback,j=e.dark,S=e.noAccordion,x=e.plotStyle,L=e.noLimit;if(!O||0===O.length)return null;var _=Object.keys(O[0].properties);return o.a.createElement("div",null,o.a.createElement("h6",null,"Generate graphs from columns"),o.a.createElement("div",{className:"searchField"},o.a.createElement(u.a,{single:!0,title:"Choose column",values:_.map((function(e){return{id:Object(h.p)(e),value:e}})),onSelectCallback:function(e){d(e),"function"===typeof w&&w(e)},value:s}),s.length>0&&o.a.createElement(u.a,{single:!0,title:"Choose vis",values:v.map((function(e){return{id:e,value:e}})),onSelectCallback:function(e){g(e)},value:p})),o.a.createElement(l.Button,{kind:l.KIND.secondary,size:l.SIZE.compact,onClick:function(){0!==s.length&&0!==p.length&&s[0]&&C([].concat(Object(a.a)(k),[b(O,s[0].value,p[0].value,x,j,L)]))}},"Add"),o.a.createElement("div",{className:"visArea"},S?o.a.createElement("center",null,k.map((function(e,t){return e&&o.a.createElement("div",null,o.a.createElement(l.Button,{kind:l.KIND.secondary,size:l.SIZE.compact,onClick:function(){C(k.filter((function(e,n){return t!==n})))}},"X"),e)}))):o.a.createElement(c.Accordion,{expanded:!0,onChange:function(e){var t=e.expanded;return console.log(t)}},k.map((function(e,t){return o.a.createElement(c.Panel,{key:"panel-"+t},o.a.createElement(l.Button,{kind:l.KIND.secondary,size:l.SIZE.compact,onClick:function(){C(k.filter((function(e,n){return t!==n})))}},"X"),e)})))))}},976:function(e){e.exports=JSON.parse('{"marker-1":{"x":0,"y":0,"width":128,"height":128,"anchorY":128},"marker-2":{"x":128,"y":0,"width":128,"height":128,"anchorY":128},"marker-3":{"x":256,"y":0,"width":128,"height":128,"anchorY":128},"marker-4":{"x":384,"y":0,"width":128,"height":128,"anchorY":128},"marker-5":{"x":0,"y":128,"width":128,"height":128,"anchorY":128},"marker-6":{"x":128,"y":128,"width":128,"height":128,"anchorY":128},"marker-7":{"x":256,"y":128,"width":128,"height":128,"anchorY":128},"marker-8":{"x":384,"y":128,"width":128,"height":128,"anchorY":128},"marker-9":{"x":0,"y":256,"width":128,"height":128,"anchorY":128},"marker-10":{"x":128,"y":256,"width":128,"height":128,"anchorY":128},"marker-20":{"x":256,"y":256,"width":128,"height":128,"anchorY":128},"marker-30":{"x":384,"y":256,"width":128,"height":128,"anchorY":128},"marker-40":{"x":0,"y":384,"width":128,"height":128,"anchorY":128},"marker-50":{"x":128,"y":384,"width":128,"height":128,"anchorY":128},"marker-60":{"x":256,"y":384,"width":128,"height":128,"anchorY":128},"marker-70":{"x":384,"y":384,"width":128,"height":128,"anchorY":128},"marker-80":{"x":0,"y":512,"width":128,"height":128,"anchorY":128},"marker-90":{"x":128,"y":512,"width":128,"height":128,"anchorY":128},"marker-100":{"x":256,"y":512,"width":128,"height":128,"anchorY":128},"marker":{"x":384,"y":512,"width":128,"height":128,"anchorY":128}}')},981:function(e,t,n){e.exports=n.p+"static/media/location-icon-atlas.37932833.png"}},[[1027,1,2]]]);
//# sourceMappingURL=main.0caac642.chunk.js.map